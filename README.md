# anomaly
Ups and downs in the history of the US dollar to the tenge for the period from 2010 to 2018
#Введение

Три года назад, в августе 2015 года, было объявлено о свободном рыночном образовании курса тенге. В правильном ли направлении, по вашему мнению, пошел Казахстан?
Теперь бменный курс тенге формируется на основе рыночного спроса и предложения с учетом фундаментальных внутренних и внешних макроэкономических факторов.

Изменение курса тенге по отношению к доллару с 2000 года показывает, что национальная валюта Казахстана не раз переживала, как взлеты, так и падения. Причем последних было, в разы больше.

    В данном проекте будет построена модель, самостоятельно определяющая аномалии в курсах доллара в разные периоды в течение 18 лет.

Данные с официальными курсами валют с 1 января 2000 года по 1 декабря 2018 года взяты с официального [**интернет-ресурса**] (https://nationalbank.kz/?docid=748&switch=russian) Национального банка Республики Казахстан.

##Загрузка необходимых библиотек

```{r libraries, echo=TRUE, message=FALSE, warning=FALSE, paged.print=FALSE}
library(readxl) #для чтения датасета в формате xls
library(anomalize) #для выявления аномалий
library(crypto) 
library(lubridate) #для работы с датами
library(dplyr) #для более быстрой работы с таблицей
library(ggplot2) #визуализация
```

```{r setup, include=FALSE}
knitr::opts_chunk$set(
	message = FALSE,
	warning = FALSE)
train <- read_xls("~/Official_Foreign_Exchange_Rates_NBRK_on_01_12_2018.xls")
```

#Подготовка таблицы

##Удаление и преобразование формата колонок

Прежде чем загрузить загруженную таблицу в модель, необходимы некоторые преобразования.
Для начала нужно посмотреть, какие переменные есть.

```{r}
head(train)
str(train)
```

Таблица состоит из 3 колонок. Первая колонка *Date* содержит дату, которую необходимо преобразовать в формат год-месяц-день при помощи пакета *lubridate*.
Вторая колонка *USD_quant* не нужна, поэтому ее нужно удалить.
И третья колонка *USD* показывает курс доллара в определенный день.

```{r}
train$Date <- ymd(train$Date)
train$USD_quant <- NULL
colnames(train) <- c("ds","y") #первая колонка ds - даты, y - курс доллара
head(train)
```

##Пропущенные значения

Очень важно выявить и удалить пропущенные значения, так как это повлияет на качество графика аномалий.

Пропущенных значений во всей таблице - `r sum(is.na(train))`.
Это значит, что можно идти дальше.

#Построение модели

При помощи функции iqr( interquartile range) из пакета *anomalize* вычислен межквартильный диапазон для датасета переменной, содержащей курс доллара.

```{r}
train$Anomaly <- iqr(train$y, alpha = 0.07, max_anoms = 0.2)
table(iqr(train$y, alpha = 0.07, max_anoms = 0.2))
train <- train[train$Anomaly!="Yes",]
train$Anomaly <- NULL
```

В качестве тренда - основной тенденцией изменения стоимости валюты - взят период в 12 недель. График покажет красным цветом те периоды, когда курс колебался более, чем на одно стандартное отклонение в месяц.

```{r}
usd_plot <- tbl_df(train) %>%
  time_decompose(y,
                 frequency = "auto",
                 trend     = "12 weeks") %>%
  anomalize(remainder) %>%
  plot_anomaly_decomposition() +
  ggtitle("Изменение курса доллара США по отношению к тенге")
```

#График

Как видно на графике, красным цветом помечены периоды девальвации.

```{r include=FALSE}
usd_plot
```

#Вывод

В данной работе показаны основные моменты изменения стоимости тенге за последние 18 лет. 

**4 февраля 2009 года**

Согласно пресс-релизу Национального банка Казахстана названы три причины для девальвации тенге. Основной причиной является понижение цен на нефть, которая занимает около шестидесяти процентов всего экспорта Казахстана.
Второй важной причиной является девальвация национальных валют в странах — торговых партнерах Казахстана и в странах, экономика которых зависит от экспорта сырья.
Третьей причиной стала необходимость сохранения золотовалютных резервов Национального Банка для дальнейшего поддержания обменного курса в приемлемых рамках.

**11 февраля 2014 года**

В 2014 году пришло время очередного валютного «антирекорда». Кстати, снова в феврале — на этот раз 11 числа. Председательствовал тогда в Нацбанке Кайрат Келимбетов (занявший этот пост с 1 октября 2013 года). Именно он сообщил о решении отказаться от поддержания обменного курса тенге на прежнем уровне. В заявлении Нацбанка говорилось, что будет установлен новый коридор колебаний курса — 185 тенге за доллар плюс/минус 3 тенге. Предыдущий курс был 155,5 тенге.

[*Источник*](https://365info.kz/2017/11/vse-devalvatsii-kazahstana-kak-eto-bylo/)

**20 августа 2015 года**

Утром 20 августа 2015 года в Казахстане установился новый курс доллара - 255 тенге. Правительство Казахстана приняло решение отпустить национальную валюту в свободное плавание. Это означает, что теперь рынок будет определять курс доллара.

Теперь внимание всего финансового мира Казахстана, да и всех интересующихся состоянием валютного рынка республики, будет привлекать состояние биржи KASE. Текущий курс финансовые институты будут определять по итогам сессий.

[*Источник*](https://tengrinews.kz/kazakhstan_news/chto-proizoshlo-v-kazahstane-20-avgusta-2015-goda-279544/).
